# **Отчёт по численному интегрированию**

## **Цель работы**  
Реализовать методы численного интегрирования — **левых прямоугольников, правых прямоугольников, средних прямоугольников, трапеций и Симпсона** — и исследовать их порядки точности с помощью **метода Рунге**.

---

## **Часть 1. Численное интегрирование различных функций**

### **1.1. Функция** \( f(x) = 64x + 19.82 \), **пределы** \([-2, 4]\)

| Метод           | n=10         | n=20         | n=50         | n=100        | n=1000       |
|------------------|--------------|--------------|--------------|--------------|--------------|
| Левые прямоугольники | 387.7200000000 | 445.3200000000 | 479.8800000000 | 491.4000000000 | 501.7680000000 |
| Правые прямоугольники| 618.1200000000 | 560.5200000000 | 525.9600000000 | 514.4400000000 | 504.0720000000 |
| Средние прямоугольники| 502.9200000000 | 502.9200000000 | 502.9200000000 | 502.9200000000 | 502.9200000000 |
| Трапеции         | 502.9200000000 | 502.9200000000 | 502.9200000000 | 502.9200000000 | 502.9200000000 |
| Симпсон          | 502.9200000000 | 502.9200000000 | 502.9200000000 | 502.9200000000 | 502.9200000000 |

**Вывод**: Для линейной функции методы **средних прямоугольников, трапеций и Симпсона** дают **точный результат** при любом \( n \), так как они интегрируют полиномы степени ≤1 точно. Методы левых и правых прямоугольников сходятся к точному значению при увеличении \( n \).

---

### **1.2. Функция** \( f(x) = x^{15} - 4x^8 + x^3 - 147 \), **пределы** \([-6, -2]\)

| Метод           | n=10               | n=20               | n=50               | n=100              | n=1000             |
|------------------|--------------------|--------------------|--------------------|--------------------|--------------------|
| Левые прямоугольники | -285826756638.49805 | -227248089142.71036 | -195758091631.86730 | -185884386528.50198 | -177265795408.13663 |
| Правые прямоугольники| -97750088856.09802  | -133209755251.51025 | -158142758075.38742 | -167076719750.26193 | -175385028730.31256 |
| Средние прямоугольники| -168669421646.92245 | -174376236685.62857 | -176010681425.13654 | -176245498517.07920 | -176323061130.84680 |
| Трапеции         | -191788422747.29800 | -180228922197.11026 | -176950424853.62738 | -176480553139.38200 | -176325412069.22460 |
| Симпсон          | -177112406435.38773 | -176375755347.04770 | -176325193280.12033 | -176323929234.63350 | -176323844784.89597 |

**Вывод**: Функция — полином высокой степени. Метод **Симпсона** сходится значительно быстрее остальных и уже при \( n = 1000 \) даёт стабильное значение ≈ **–1.76323845×10¹¹**. Методы левых и правых прямоугольников сходятся медленно и асимметрично.

---

### **1.3. Функция** \( f(x) = \sqrt{x + 32} \), **пределы** \([1, 2]\)

| Метод           | n=10       | n=20       | n=50       | n=100      | n=1000     |
|------------------|------------|------------|------------|------------|------------|
| Левые прямоугольники | 5.7835441890 | 5.7857047261 | 5.7870007905 | 5.7874327690 | 5.7878215313 |
| Правые прямоугольники| 5.7921831138 | 5.7900241885 | 5.7887285755 | 5.7882966615 | 5.7879079205 |
| Средние прямоугольники| 5.7878652633 | 5.7878648603 | 5.7878647475 | 5.7878647314 | 5.7878647260 |
| Трапеции         | 5.7878636514 | 5.7878644573 | 5.7878646830 | 5.7878647152 | 5.7878647259 |
| Симпсон          | 5.7878647260 | 5.7878647260 | 5.7878647260 | 5.7878647260 | 5.7878647260 |

**Вывод**: Все методы сходятся к значению ≈ **5.7878647260**. Метод **Симпсона** достигает машинной точности уже при \( n = 10 \).

---

### **1.4. Функция** \( f(x) = \dfrac{1}{(x + 3)^5} \), **пределы** \([0, 3]\)

| Метод           | n=10       | n=20       | n=50       | n=100      | n=1000     |
|------------------|------------|------------|------------|------------|------------|
| Левые прямоугольники | 0.0035417962 | 0.0032051523 | 0.0030151422 | 0.0029538242 | 0.0028995035 |
| Правые прямоугольники| 0.0023458086 | 0.0026071584 | 0.0027759446 | 0.0028342255 | 0.0028875436 |
| Средние прямоугольники| 0.0028685083 | 0.0028872085 | 0.0028925063 | 0.0028932654 | 0.0028935160 |
| Трапеции         | 0.0029438024 | 0.0029061553 | 0.0028955434 | 0.0028940248 | 0.0028935236 |
| Симпсон          | 0.0028948423 | 0.0028936063 | 0.0028935208 | 0.0028935187 | 0.0028935185 |

**Вывод**: Функция гладкая и быстро убывает. Все методы сходятся к ≈ **0.0028935185**. Симпсон стабилизируется уже при \( n = 50 \).

---

### **1.5. Функция** \( f(x) = \ln(x^2 + 9x - 3) \), **пределы** \([10, 12]\)

| Метод           | n=10       | n=20       | n=50       | n=100      | n=1000     |
|------------------|------------|------------|------------|------------|------------|
| Левые прямоугольники | 10.7273462791 | 10.7417198662 | 10.7503259795 | 10.7531916773 | 10.7557695200 |
| Правые прямоугольники| 10.7846151350 | 10.7703542942 | 10.7617797507 | 10.7589185629 | 10.7563422086 |
| Средние прямоугольники| 10.7560934533 | 10.7560652675 | 10.7560573751 | 10.7560562476 | 10.7560558756 |
| Трапеции         | 10.7559807071 | 10.7560370802 | 10.7560528651 | 10.7560551201 | 10.7560558643 |
| Симпсон          | 10.7560558627 | 10.7560558712 | 10.7560558718 | 10.7560558718 | 10.7560558718 |

**Вывод**: Сходимость хорошая. Симпсон даёт стабильный результат ≈ **10.7560558718** уже при \( n = 50 \).

---

### **1.6. Функция** \( f(x) = \sin\left(\frac{6}{7}\pi x + x - 3\pi\right) \), **пределы** \(\left[-\frac{\pi}{4}, \frac{9\pi}{5}\right]\)

| Метод           | n=10       | n=20       | n=50       | n=100      | n=1000     |
|------------------|------------|------------|------------|------------|------------|
| Левые прямоугольники | 0.4331112099 | 0.3077037869 | 0.2126213560 | 0.1781215000 | 0.1459169780 |
| Правые прямоугольники| -0.2973117893| -0.0575077127| 0.0665367561 | 0.1050792001 | 0.1386127481 |
| Средние прямоугольники| 0.1822963639 | 0.1510129706 | 0.1436216440 | 0.1426074159 | 0.1422749220 |
| Трапеции         | 0.0678997103 | 0.1250980371 | 0.1395790561 | 0.1416003500 | 0.1422648630 |
| Симпсон          | 0.2084088696 | 0.1441641460 | 0.1423131428 | 0.1422741147 | 0.1422715692 |

**Вывод**: Функция осциллирует, но не критично. Все методы сходятся к ≈ **0.14227** при \( n = 1000 \). Симпсон наиболее эффективен.

---

### **1.7. Функция** \( f(x) = \dfrac{1}{1 + e^x} \), **пределы** \([0, 1]\)

| Метод           | n=10       | n=20       | n=50       | n=100      | n=1000     |
|------------------|------------|------------|------------|------------|------------|
| Левые прямоугольники | 0.3914829245 | 0.3856730808 | 0.3821978585 | 0.3810412308 | 0.3800010268 |
| Правые прямоугольники| 0.3683770666 | 0.3741201519 | 0.3775766869 | 0.3787306451 | 0.3797699682 |
| Средние прямоугольники| 0.3798632371 | 0.3798799311 | 0.3798846032 | 0.3798852706 | 0.3798854908 |
| Трапеции         | 0.3799299956 | 0.3798966163 | 0.3798872727 | 0.3798859379 | 0.3798854975 |
| Симпсон          | 0.3798854430 | 0.3798854899 | 0.3798854930 | 0.3798854930 | 0.3798854930 |

**Вывод**: Все методы сходятся к ≈ **0.3798854930**. Симпсон достигает точности уже при \( n = 50 \).

---


## **Часть 2. Анализ порядков точности методов (метод Рунге)**

### **2.1. Функция** \( f(x) = x^{11} - 5x^8 + 0.654x^3 - x \), **пределы** \([-3, 1]\)

| Метод           | Оценка порядка \( p \) | Теоретический порядок |
|------------------|------------------------|------------------------|
| Левые прямоугольники | 1.0025                 | 1                      |
| Правые прямоугольники| 0.9975                 | 1                      |
| Средние прямоугольники| 1.99999                | 2                      |
| Трапеции         | 1.999997               | 2                      |
| Симпсон          | **3.9993**             | **4**                  |

**Анализ**:  
Результаты **в точности подтверждают теоретические порядки сходимости**. Отклонения от целых значений не превышают \( 3 \times 10^{-3} \), что объясняется исключительно погрешностями округления при вычислениях в арифметике двойной точности. Это демонстрирует корректность реализации всех методов.

---

### **2.2. Функция** \( f(x) = \sin(x^2 - 0.3x + 4\pi) \cdot \cos\left(\dfrac{\pi}{7}x + 1\right) \), **пределы** \([-\pi,\; 15\pi/2] \approx [-3.14,\; 23.56]\)

| Метод           | Оценка порядка \( p \) | Теоретический порядок |
|------------------|------------------------|------------------------|
| Левые прямоугольники | 0.9915                 | 1                      |
| Правые прямоугольники| 1.0084                 | 1                      |
| Средние прямоугольники| 2.1084                 | 2                      |
| Трапеции         | 2.0632                 | 2                      |
| Симпсон          | **4.2904**             | **4**                  |

**Анализ**:  
Несмотря на высокую частоту осцилляций (особенно из-за члена \( \sin(x^2) \)), использование **мелкой сетки (\( n_0 = 1000 \))** позволило корректно разрешить поведение функции.  

---

## **Выводы**

1. **Метод Симпсона** демонстрирует наивысшую точность и скорость сходимости для гладких функций, подтверждая теоретический порядок \( p = 4 \).
2. **Методы средних прямоугольников и трапеций** имеют порядок \( p \approx 2 \) и хорошо работают на большинстве тестов.
3. **Левые и правые прямоугольники** имеют порядок \( p \approx 1 \), но могут сходиться асимметрично.
4. Для **линейных функций** методы средних прямоугольников, трапеций и Симпсона дают **точный результат** при любом \( n \).
5. На **быстроосциллирующих функциях** с длинными интервалами стандартные квадратурные формулы требуют **очень мелких сеток**; иначе метод Рунге даёт неадекватные оценки.
6. **Метод Рунге** эффективен для оценки порядка сходимости **только при достаточной гладкости и адекватном разбиении**.
