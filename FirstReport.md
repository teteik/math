# Отчёт по численному интегрированию

## Цель работы  
Реализовать методы численного интегрирования (левых, правых и средних прямоугольников, трапеций, Симпсона) и исследовать их порядки точности с помощью метода Рунге.

---

## Часть 1. Численное интегрирование различных функций

### 1.1. Функция \( f(x) = 64x + 19.82 \), пределы \([-2, 4]\)

| Метод           | n=10         | n=20         | n=50         | n=100        | n=1000       |
|------------------|--------------|--------------|--------------|--------------|--------------|
| Левые прямоугольники | 387.7200     | 445.3200     | 479.8800     | 491.4000     | 501.7680     |
| Правые прямоугольники| 618.1200     | 560.5200     | 525.9600     | 514.4400     | 504.0720     |
| Средние прямоугольники| **502.9200** | **502.9200** | **502.9200** | **502.9200** | **502.9200** |
| Трапеции         | **502.9200** | **502.9200** | **502.9200** | **502.9200** | **502.9200** |
| Симпсон          | **502.9200** | **502.9200** | **502.9200** | **502.9200** | **502.9200** |

**Вывод**: Для линейной функции методы средних прямоугольников, трапеций и Симпсона дают **точный результат** даже при малых \( n \).

---

### 1.2. Функция \( f(x) = x^{15} - 4x^8 + x^3 - 147 \), пределы \([-6, -2]\)

| Метод           | n=10               | n=20               | n=50               | n=100              | n=1000             |
|------------------|--------------------|--------------------|--------------------|--------------------|--------------------|
| Левые прямоугольники | -2.858e+11         | -2.272e+11         | -1.958e+11         | -1.859e+11         | -1.773e+11         |
| Правые прямоугольники| -9.775e+10         | -1.332e+11         | -1.581e+11         | -1.671e+11         | -1.754e+11         |
| Средние прямоугольники| -1.687e+11         | -1.744e+11         | -1.760e+11         | -1.762e+11         | -1.763e+11         |
| Трапеции         | -1.918e+11         | -1.802e+11         | -1.770e+11         | -1.765e+11         | -1.763e+11         |
| Симпсон          | -1.771e+11         | -1.764e+11         | -1.763e+11         | -1.763e+11         | **-1.763e+11**     |

**Вывод**: Для полинома высокой степени **метод Симпсона** сходится значительно быстрее остальных.

---

### 1.3. Функция \( f(x) = \sqrt{x + 32} \), пределы \([1, 2]\)

| Метод           | n=10       | n=20       | n=50       | n=100      | n=1000     |
|------------------|------------|------------|------------|------------|------------|
| Средние прямоугольники| 5.78786526 | 5.78786486 | 5.78786475 | 5.78786473 | **5.78786473** |
| Трапеции         | 5.78786365 | 5.78786446 | 5.78786468 | 5.78786472 | **5.78786473** |
| Симпсон          | **5.78786473** | **5.78786473** | **5.78786473** | **5.78786473** | **5.78786473** |

**Вывод**: Все методы сходятся к значению ≈ **5.7878647260**, метод Симпсона достигает высокой точности уже при \( n = 10 \).

---

### 1.4. Функция \( f(x) = \dfrac{1}{(x + 3)^5} \), пределы \([0, 3]\)

| Метод           | n=10       | n=20       | n=50       | n=100      | n=1000     |
|------------------|------------|------------|------------|------------|------------|
| Средние прямоугольники| 0.00286851 | 0.00288721 | 0.00289251 | 0.00289327 | **0.00289352** |
| Трапеции         | 0.00294380 | 0.00290616 | 0.00289554 | 0.00289402 | **0.00289352** |
| Симпсон          | 0.00289484 | 0.00289361 | 0.00289352 | **0.00289352** | **0.00289352** |

**Вывод**: Функция быстро убывает, но **гладкая** на отрезке — все методы сходятся хорошо. Симпсон стабилизируется уже при \( n = 50 \).

---

### 1.5. Функция \( f(x) = \ln(x^2 + 9x - 3) \), пределы \([10, 12]\)

| Метод           | n=10       | n=20       | n=50       | n=100      | n=1000     |
|------------------|------------|------------|------------|------------|------------|
| Средние прямоугольники| 10.75609345| 10.75606527| 10.75605738| 10.75605625| **10.75605588** |
| Трапеции         | 10.75598071| 10.75603708| 10.75605287| 10.75605512| **10.75605586** |
| Симпсон          | **10.75605586** | **10.75605587** | **10.75605587** | **10.75605587** | **10.75605587** |

**Вывод**: Метод Симпсона даёт стабильный результат ≈ **10.7560558718** уже при \( n = 10 \).

---

### 1.6. Функция \( f(x) = \sin\left(\frac{6}{7}\pi x + x - 3\pi\right) \), пределы \(\left[-\frac{\pi}{4}, \frac{9\pi}{5}\right]\)

| Метод           | n=10   | n=20   | n=50   | n=100  | n=1000 |
|------------------|--------|--------|--------|--------|--------|
| Средние прямоугольники| 0.1823 | 0.1510 | 0.1436 | 0.1426 | **0.1423** |
| Трапеции         | 0.0679 | 0.1251 | 0.1396 | 0.1416 | **0.1423** |
| Симпсон          | 0.2084 | 0.1442 | 0.1423 | **0.1423** | **0.1423** |

**Вывод**: Функция осциллирует, но **не слишком быстро**. Сходимость наблюдается при \( n \geq 100 \), метод Симпсона наиболее эффективен.

---

### 1.7. Функция \( f(x) = \dfrac{1}{1 + e^x} \), пределы \([0, 1]\)

| Метод           | n=10       | n=20       | n=50       | n=100      | n=1000     |
|------------------|------------|------------|------------|------------|------------|
| Средние прямоугольники| 0.37986324 | 0.37987993 | 0.37988460 | 0.37988527 | **0.37988549** |
| Трапеции         | 0.37992999 | 0.37989662 | 0.37988727 | 0.37988594 | **0.37988550** |
| Симпсон          | 0.37988544 | 0.37988549 | **0.37988549** | **0.37988549** | **0.37988549** |

**Вывод**: Все методы сходятся к значению ≈ **0.3798854930**. Симпсон достигает машинной точности уже при \( n = 50 \).

---

## Часть 2. Анализ порядков точности методов (метод Рунге)

### 2.1. Функция \( f(x) = x^{11} - 5x^8 + 0.654x^3 - x \), пределы \([-3, 1]\)

| Метод           | Порядок \( p \) | Теоретический \( p \) |
|------------------|------------------|------------------------|
| Левые прямоугольники | 1.1910           | 1                      |
| Правые прямоугольники| 0.6759           | 1                      |
| Средние прямоугольники| 1.9408           | 2                      |
| Трапеции         | 1.9666           | 2                      |
| Симпсон          | **3.8699**       | **4**                  |

**Анализ**:  
Экспериментальные порядки близки к теоретическим. Небольшое отклонение у правых прямоугольников связано с асимметрией функции на отрезке. Метод Симпсона демонстрирует почти идеальный порядок 4.

---

### 2.2. Функция \( f(x) = \sin(x^2 - 0.3x + 4\pi) \cdot \cos\left(\frac{\pi}{7}x + 1\right) \), пределы \([-\pi, \frac{15\pi}{2}]\)

| Метод           | Порядок \( p \) | Теоретический \( p \) |
|------------------|------------------|------------------------|
| Левые прямоугольники | 0.6462           | 1                      |
| Правые прямоугольники| 2.1152           | 1                      |
| Средние прямоугольники| **-3.0234**      | 2                      |
| Трапеции         | -0.1037          | 2                      |
| Симпсон          | 0.9372           | 4                      |

**Анализ**:  
Функция **быстро осциллирует**, особенно на длинном интервале. Это приводит к **нестабильной сходимости** и даже **отрицательным порядкам**, что указывает на недостаточное разбиение сетки. Для корректной оценки требуется значительно увеличить \( n \) (например, до \( 10^4 \) или \( 10^5 \)).

---

## Выводы

1. **Метод Симпсона** показывает наивысшую точность и скорость сходимости для гладких функций, подтверждая теоретический порядок \( p = 4 \).
2. **Методы средних прямоугольников и трапеций** имеют порядок \( p \approx 2 \) и хорошо работают на большинстве тестовых функций.
3. **Левые и правые прямоугольники** имеют порядок \( p \approx 1 \) и наименее эффективны.
4. Для **линейных функций** методы средних прямоугольников, трапеций и Симпсона дают **точный результат** независимо от \( n \).
5. **Быстроосциллирующие функции** требуют очень мелких сеток; стандартные квадратурные формулы могут давать неустойчивые результаты при малых \( n \).
6. **Метод Рунге** успешно подтверждает теоретические порядки точности на гладких функциях, но **не применим напрямую** к плохо сходящимся случаям без увеличения разбиения.
